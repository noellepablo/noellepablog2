<!DOCTYPE html>
<html
  dir="ltr"
  lang="en"
  data-theme=""
  class="html"
><head>
  <title>
    
      
        Cleaning HTML Code in R |

      Noelle Pablo

  </title>

  
  <meta charset="utf-8" /><meta name="generator" content="Hugo 0.79.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="author" content="Noelle Pablo" />
  <meta
    name="description"
    content=""
  />
  
  
    
    
    <link
      rel="stylesheet"
      href="/scss/main.min.f56f0970bc00d4c7ffdb126b93d067aa889f87a5604f2b2a77770478f3966a03.css"
      integrity="sha256-9W8JcLwA1Mf/2xJrk9Bnqoifh6VgTysqd3cEePOWagM="
      crossorigin="anonymous"
      type="text/css"
    />

  

  
  <link
    rel="stylesheet"
    href="/css/markupHighlight.min.793b323d7f2d9fbfd0b93f4d593fb5ad77b918716ed33eddea403fa87f770403.css"
    integrity="sha256-eTsyPX8tn7/QuT9NWT&#43;1rXe5GHFu0z7d6kA/qH93BAM="
    crossorigin="anonymous"
    type="text/css"
  />
  
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/fontawesome.min.b1c4e6a10bdbab01f33fff9d78816ee68cf9a9a731f07668afd546a79924cb80.css"
    integrity="sha256-scTmoQvbqwHzP/&#43;deIFu5oz5qacx8HZor9VGp5kky4A="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/solid.min.423dee17c62f55fa733a4ee13e00d523dfce88cc4f4ab4549a24ba36bd9de681.css"
    integrity="sha256-Qj3uF8YvVfpzOk7hPgDVI9/OiMxPSrRUmiS6Nr2d5oE="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/brands.min.b7d54133b27e5b4de15245b8e143de3e8ed2d674c706137274cedc9953f31917.css"
    integrity="sha256-t9VBM7J&#43;W03hUkW44UPePo7S1nTHBhNydM7cmVPzGRc="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />

  <link rel="canonical" href="https://example.com/post/cleaning-html-code-in-r/" />

  
  
  
  
  <script
    type="text/javascript"
    src="/js/anatole-header.min.5c846cefa5ed21cceee981c70901aaf21b17b4e0b05bd777af840780918abea9.js"
    integrity="sha256-XIRs76XtIczu6YHHCQGq8hsXtOCwW9d3r4QHgJGKvqk="
    crossorigin="anonymous"
  ></script>

  
    
    
    <script
      type="text/javascript"
      src="/js/anatole-theme-switcher.min.245da778410d349aba672975fe9ff04e24e608155cc9102b5c1c70554c1539c0.js"
      integrity="sha256-JF2neEENNJq6Zyl1/p/wTiTmCBVcyRArXBxwVUwVOcA="
      crossorigin="anonymous"
    ></script>

  

  


  
  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://example.com/images/site-feature-image.png"/>

<meta name="twitter:title" content="Cleaning HTML Code in R"/>
<meta name="twitter:description" content="Working at ATLAS involves a lot of student assessment data, including text responses."/>



  
  <meta property="og:title" content="Cleaning HTML Code in R" />
<meta property="og:description" content="Working at ATLAS involves a lot of student assessment data, including text responses." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/post/cleaning-html-code-in-r/" />
<meta property="og:image" content="https://example.com/images/site-feature-image.png"/>
<meta property="article:published_time" content="2021-07-20T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-07-20T00:00:00+00:00" /><meta property="og:site_name" content="Noelle Pablo" />



  
  
  
  
  <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "articleSection": "post",
        "name": "Cleaning HTML Code in R",
        "headline": "Cleaning HTML Code in R",
        "alternativeHeadline": "",
        "description": "
      
        Working at ATLAS involves a lot of student assessment data, including text responses.


      


    ",
        "inLanguage": "en",
        "isFamilyFriendly": "true",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/example.com\/post\/cleaning-html-code-in-r\/"
        },
        "author" : {
            "@type": "Person",
            "name": "Noelle Pablo"
        },
        "creator" : {
            "@type": "Person",
            "name": "Noelle Pablo"
        },
        "accountablePerson" : {
            "@type": "Person",
            "name": "Noelle Pablo"
        },
        "copyrightHolder" : {
            "@type": "Person",
            "name": "Noelle Pablo"
        },
        "copyrightYear" : "2021",
        "dateCreated": "2021-07-20T00:00:00.00Z",
        "datePublished": "2021-07-20T00:00:00.00Z",
        "dateModified": "2021-07-20T00:00:00.00Z",
        "publisher":{
            "@type":"Organization",
            "name": "Noelle Pablo",
            "url": "https://example.com",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/example.com\/favicons\/favicon-32x32.png",
                "width":"32",
                "height":"32"
            }
        },
        "image": 
      [
        
        "https://example.com/images/site-feature-image.png"


      
      ]

    ,
        "url" : "https:\/\/example.com\/post\/cleaning-html-code-in-r\/",
        "wordCount" : "536",
        "genre" : [ ],
        "keywords" : [ ]
    }
  </script>



</head>
<body
    
      class="body theme--light"

    
  >
    <div class="wrapper">
      <aside
        
          class="wrapper__sidebar"

        
      ><div
  class="sidebar
    animated fadeInDown

  "
>
  <div class="sidebar__content">
    <div class="sidebar__introduction">
      <img
        class="sidebar__introduction-profileimage"
        src="/images/linkedinpiccropped.jpg"
        alt="profile picture"
      />
      
        <div class="sidebar__introduction-title">
          <a href="/">Noelle Pablo</a>
        </div>

      
      <div class="sidebar__introduction-description">
        <p></p>
      </div>
    </div>
    <ul class="sidebar__list">
      
        <li class="sidebar__list-item">
          <a
            href="https://www.linkedin.com/in/noelle-pablo/"
            target="_blank"
            rel="noopener"
            aria-label="Linkedin"
            title="Linkedin"
          >
            <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
          </a>
        </li>

      
        <li class="sidebar__list-item">
          <a
            href="https://github.com/noellepablo"
            target="_blank"
            rel="noopener"
            aria-label="GitHub"
            title="GitHub"
          >
            <i class="fab fa-github fa-2x" aria-hidden="true"></i>
          </a>
        </li>

      
        <li class="sidebar__list-item">
          <a
            href="mailto:noellebpablo@gmail.com"
            target="_blank"
            rel="noopener"
            aria-label="e-mail"
            title="e-mail"
          >
            <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
          </a>
        </li>

      
    </ul>
  </div><footer class="footer footer__sidebar">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Noelle Pablo
        2022


      
    </li>
    
      <li class="footer__item">
        <a
          class="link"
          href="/imprint/"
          
          title=""
        >
          imprint
        </a>
      </li>

    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.7d3bf3472b73d9ba107b3de37d0df8fa736593a3c6638c95eaed42006bfc0193.js"
    integrity="sha256-fTvzRytz2boQez3jfQ34&#43;nNlk6PGY4yV6u1CAGv8AZM="
    crossorigin="anonymous"
  ></script></div>
</aside>
      <main
        
          class="wrapper__main"

        
      >
        <header class="header"><div
  class="
    animated fadeInDown

  "
>
  <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
  </a>
  <nav class="nav">
    <ul class="nav__list" id="navMenu">
      
      
        
        
          <li class="nav__list-item">
            <a
              
              href="/"
              
              title=""
              >Home</a
            >
          </li>

        


      
        
        
          <li class="nav__list-item">
            <a
              
              href="/post/"
              
              title=""
              >Posts</a
            >
          </li>

        


      
        
        
          <li class="nav__list-item">
            <a
              
              href="/about/"
              
              title=""
              >About</a
            >
          </li>

        


      
        
        

          <li class="nav__list-item">
            <div class="optionswitch">
              <input class="optionswitch__picker" type="checkbox" id="3" hidden />

              
              
                


              


              <label class="optionswitch__label" for="3"
                >Accomplishments <i class="fa fa-angle-down" aria-hidden="true"></i
              ></label>

              <div class="optionswitch__triangle"></div>
              <ul class="optionswitch__list">
                
                  <li class="optionswitch__list-item">
                    <a
                      href="/certifications/"
                      
                      title=""
                      >Certifications</a
                    >
                  </li>

                
              </ul>
            </div>
          </li>

        


      
        
        
          <li class="nav__list-item">
            <a
              
              href="/contact/"
              
              title=""
              >Contact</a
            >
          </li>

        


      
    </ul>
    <ul class="nav__list nav__list--end">
      
      
        <li class="nav__list-item">
          <div class="themeswitch">
            <a title="Switch Theme">
              <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a>
          </div>
        </li>

      
    </ul>
  </nav>
</div>
</header>
  <div
    class="post 
      animated fadeInDown

    "
  >
    
    <div class="post__content">
      <h1>Cleaning HTML Code in R</h1>
      
        <ul class="post__meta">
          <li class="post__meta-item">
            <em class="fas fa-calendar-day post__meta-icon"></em>
            <span class="post__meta-text"
              >
                20/7/2021


              
            </span>
          </li>
          <li class="post__meta-item">
            <em class="fas fa-stopwatch post__meta-icon"></em>
            <span class="post__meta-text">3-minute read</span>
          </li>
        </ul>

      
<script src="index_files/header-attrs/header-attrs.js"></script>


<p>Working at <a href="https://atlas.ku.edu/">ATLAS</a> involves a lot of student assessment data, including text responses. For certain projects, the data are sent to our team with residual HTML code in the text response strings, for example, <code>It's</code> might appear as <code>It&amp;#39;s</code>, since the HTML code for an apostrophe is denoted by <code>&amp;#39;</code>. To make these responses more readable, it is helpful to clean, or replace, the HTML markup with the equivalent symbols.</p>
<p>The response data I most recently cleaned contained HTML code and various Unicode numbers, such as <code>U+200B</code>, which represents a zero width space. To clean the HTML code and Unicode numbers from the response strings, I used a combination of the <code>replace_html()</code> function within the <code>textclean</code> package and the <code>HTMLdecode()</code> function within the <code>textutils</code> package. Both functions were needed since there are some Unicode numbers that <code>replace_html()</code> recognizes that <code>HTMLdecode()</code> does not, and vice versa.</p>
<pre class="r"><code>responses &lt;- c(&quot;It&amp;#39;s a beautiful day&quot;, 
                  &quot;I like&amp;nbsp;to go fishing&quot;,
                  &quot;Jack &amp;amp; Jill went up the hill&quot;,
                  &quot;hello&lt;U+200B&gt;&quot;)
textclean::replace_html(responses)</code></pre>
<pre><code>## [1] &quot;It&amp;#39;s a beautiful day&quot;     &quot;I like to go fishing&quot;        
## [3] &quot;Jack &amp; Jill went up the hill&quot; &quot;hello &quot;</code></pre>
<pre class="r"><code>textutils::HTMLdecode(responses)</code></pre>
<pre><code>## [1] &quot;It&#39;s a beautiful day&quot;         &quot;I likeÂ to go fishing&quot;        
## [3] &quot;Jack &amp; Jill went up the hill&quot; &quot;hello&lt;U+200B&gt;&quot;</code></pre>
<p>As seen in the example above, <code>replace_html()</code> does not replace <code>&amp;#39;</code> with an apostrophe, and <code>HTMLdecode()</code> does not replace <code>&lt;U+200B&gt;</code> with a zero width space, so both functions must be used together to properly clean the HTML and Unicode markup.</p>
<p>The residual HTML code and Unicode numbers were present in student responses across multiple files. Rather than copying and pasting these two functions for each file, I wrote a function to read in the file, apply both functions to the column containing the response strings, and save the file under a new name.</p>
<pre class="r"><code>fix_html &lt;- function(file){
  data &lt;- readr::read_csv(file)
  newfilename &lt;- stringr::str_replace(file, &quot;.csv&quot;, &quot;_noCode.xlsx&quot;)
  data %&gt;% 
    mutate(new_readableresponse = textutils::HTMLdecode(response),
           new_readableresponse = textclean::replace_html(new_readableresponse)) %&gt;% 
    openxlsx::write.xlsx(file = newfilename)
}</code></pre>
<p>The function accepts one argument, <code>file</code>, which represents the file name. The first line of the function reads in the file (in this case, it is a .csv file), and the second line of the function creates a new file name, which is the same as the original file name, but with a "_noCode.xlsx" suffix. I chose to save the file with an .xlsx extension to avoid any formatting issues which sometimes occur with .csv files. The remaining lines in the function apply the <code>HTMLdecode()</code> and <code>replace_html()</code> functions to the <code>response</code> column in the data and save the results in a <code>new_readableresponse</code> column. Lastly, the data is written to a new file.</p>
<p>To further automate the HTML/Unicode cleaning process, I created a vector of all the files in the folder that needed to be cleaned and passed that vector to the <code>fix_html()</code> function using <code>purrr::map()</code>.</p>
<pre class="r"><code>filepath &lt;- &quot;S:/Projects/writing/grade9-12/&quot;
files &lt;- list.files(filepath, full.names = TRUE)

purrr::map(files, fix_html)</code></pre>
<p>The <code>purrr::map()</code> function is very useful when applying a function to a vector or list. In this case, I applied, or mapped, my newly created function <code>fix_html()</code> to a vector of file names. The final results were new versions of each file that included a new, readable response column without any HTML or Unicode numbers.</p>
</div>
    <div class="post__footer">
      

      
    </div>

    
  </div>


      </main>
    </div><footer class="footer footer__base">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Noelle Pablo
        2022


      
    </li>
    
      <li class="footer__item">
        <a
          class="link"
          href="/imprint/"
          
          title=""
        >
          imprint
        </a>
      </li>

    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.7d3bf3472b73d9ba107b3de37d0df8fa736593a3c6638c95eaed42006bfc0193.js"
    integrity="sha256-fTvzRytz2boQez3jfQ34&#43;nNlk6PGY4yV6u1CAGv8AZM="
    crossorigin="anonymous"
  ></script></body>
</html>
